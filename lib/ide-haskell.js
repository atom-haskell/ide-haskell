module.exports = {
    config: require('./config'),
    cleanConfig: function () { },
    activate: function (state) {
        this.cleanConfig();
        atom.views.getView(atom.workspace).classList.add('ide-haskell');
        require('etch').setScheduler(atom.views);
        this.upiProvided = false;
        if (atom.config.get('ide-haskell.startupMessageIdeBackend')) {
            setTimeout(() => {
                if (!this.upiProvided) {
                    atom.notifications.addWarning(`
            Ide-Haskell needs backends that provide most of functionality.
            Please refer to README for details
            `, { dismissable: true });
                }
            }, 5000);
        }
        let { CompositeDisposable } = require('atom');
        this.disposables = new CompositeDisposable();
        let PluginManager = require('./plugin-manager');
        this.pluginManager = new PluginManager(state);
        this.disposables.add(atom.commands.add('atom-workspace', {
            'ide-haskell:toggle-output': () => this.pluginManager.togglePanel()
        }));
        let { prettifyFile } = require('./prettify');
        this.disposables.add(atom.commands.add('atom-text-editor[data-grammar~="haskell"]', {
            'ide-haskell:prettify-file': ({ currentTarget }) => prettifyFile(currentTarget.getModel()),
            'ide-haskell:close-tooltip': ({ currentTarget, abortKeyBinding }) => {
                let controller = this.pluginManager.controller(currentTarget.getModel());
                if (!controller)
                    return;
                if (controller.hasTooltips && controller.hasTooltips()) {
                    controller.hideTooltip();
                }
                else if (abortKeyBinding) {
                    abortKeyBinding();
                }
            },
            'ide-haskell:next-error': () => this.pluginManager.nextError(),
            'ide-haskell:prev-error': () => this.pluginManager.prevError()
        }));
        this.disposables.add(atom.commands.add('atom-text-editor[data-grammar~="cabal"]', {
            'ide-haskell:prettify-file': ({ currentTarget }) => prettifyFile(currentTarget.getModel(), 'cabal')
        }));
        atom.keymaps.add('ide-haskell', {
            'atom-text-editor[data-grammar~="haskell"]': { 'escape': 'ide-haskell:close-tooltip' }
        });
        let { MainMenuLabel } = require('./utils');
        this.menu = new CompositeDisposable();
        this.menu.add(atom.menu.add([{
                label: MainMenuLabel,
                submenu: [
                    { label: 'Prettify', command: 'ide-haskell:prettify-file' },
                    { label: 'Toggle Panel', command: 'ide-haskell:toggle-output' }
                ]
            }]));
        let UPI = require('./upi-0.3');
        this.upi3 = new UPI(this.pluginManager);
    },
    deactivate: function () {
        this.pluginManager.deactivate();
        this.pluginManager = null;
        this.upi3.dispose();
        this.upi3 = null;
        atom.keymaps.removeBindingsFromSource('ide-haskell');
        this.disposables.dispose();
        this.disposables = null;
        this.menu.dispose();
        this.menu = null;
        atom.menu.update();
    },
    serialize: function () {
        if (this.pluginManager)
            return this.pluginManager.serialize();
    },
    provideUpi: function () {
        this.upiProvided = true;
        const UPI = require('./upi');
        return new UPI(this.pluginManager);
    },
    provideUpi3: function () {
        this.upiProvided = true;
        return this.upi3;
    },
    consumeLinter: function (indieRegistry) {
        let linter = indieRegistry.register({ name: 'IDE-Haskell' });
        this.disposables.add(linter);
        this.pluginManager.setLinter(linter);
        return linter;
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWRlLWhhc2tlbGwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaWRlLWhhc2tlbGwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTSxDQUFDLE9BQU8sR0FBRztJQUNmLE1BQU0sRUFBRSxPQUFPLENBQUMsVUFBVSxDQUFDO0lBRTNCLFdBQVcsRUFBRSxjQUFhLENBQUM7SUFFM0IsUUFBUSxFQUFFLFVBQVUsS0FBSztRQUN2QixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUE7UUFFbEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUE7UUFFL0QsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7UUFFeEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUE7UUFFeEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsc0NBQXNDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUQsVUFBVSxDQUFDO2dCQUNULEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7b0JBQ3RCLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDOzs7YUFHM0IsRUFBRSxFQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFBO2dCQUMzQixDQUFDO1lBQ0gsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQ1YsQ0FBQztRQUVELElBQUksRUFBQyxtQkFBbUIsRUFBQyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUMzQyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksbUJBQW1CLEVBQUUsQ0FBQTtRQUU1QyxJQUFJLGFBQWEsR0FBRyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQTtRQUMvQyxJ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TUFBTSxDQUFDLENBQUE7UUFDcEMsTUFBTSxDQUFDLE1BQU0sQ0FBQTtJQUNmLENBQUM7Q0FDRixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNvbmZpZzogcmVxdWlyZSgnLi9jb25maWcnKSxcblxuICBjbGVhbkNvbmZpZzogZnVuY3Rpb24gKCkge30sXG5cbiAgYWN0aXZhdGU6IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgIHRoaXMuY2xlYW5Db25maWcoKVxuXG4gICAgYXRvbS52aWV3cy5nZXRWaWV3KGF0b20ud29ya3NwYWNlKS5jbGFzc0xpc3QuYWRkKCdpZGUtaGFza2VsbCcpXG5cbiAgICByZXF1aXJlKCdldGNoJykuc2V0U2NoZWR1bGVyKGF0b20udmlld3MpXG5cbiAgICB0aGlzLnVwaVByb3ZpZGVkID0gZmFsc2VcblxuICAgIGlmIChhdG9tLmNvbmZpZy5nZXQoJ2lkZS1oYXNrZWxsLnN0YXJ0dXBNZXNzYWdlSWRlQmFja2VuZCcpKSB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnVwaVByb3ZpZGVkKSB7XG4gICAgICAgICAgYXRvbS5ub3RpZmljYXRpb25zLmFkZFdhcm5pbmcoYFxuICAgICAgICAgICAgSWRlLUhhc2tlbGwgbmVlZHMgYmFja2VuZHMgdGhhdCBwcm92aWRlIG1vc3Qgb2YgZnVuY3Rpb25hbGl0eS5cbiAgICAgICAgICAgIFBsZWFzZSByZWZlciB0byBSRUFETUUgZm9yIGRldGFpbHNcbiAgICAgICAgICAgIGAsIHtkaXNtaXNzYWJsZTogdHJ1ZX0pXG4gICAgICAgIH1cbiAgICAgIH0sIDUwMDApXG4gICAgfVxuXG4gICAgbGV0IHtDb21wb3NpdGVEaXNwb3NhYmxlfSA9IHJlcXVpcmUoJ2F0b20nKVxuICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpXG5cbiAgICBsZXQgUGx1Z2luTWFuYWdlciA9IHJlcXVpcmUoJy4vcGx1Z2luLW1hbmFnZXInKVxuICAgIHRoaXMucGx1Z2luTWFuYWdlciA9IG5ldyBQbHVnaW5NYW5hZ2VyKHN0YXRlKVxuXG4gICAgLy8gZ2xvYmFsIGNvbW1hbmRzXG4gICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQoYXRvbS5jb21tYW5kcy5hZGQoJ2F0b20td29ya3NwYWNlJywge1xuICAgICAgJ2lkZS1oYXNrZWxsOnRvZ2dsZS1vdXRwdXQnOiAoKSA9PlxuICAgICAgICB0aGlzLnBsdWdpbk1hbmFnZXIudG9nZ2xlUGFuZWwoKVxuICAgIH0pKVxuXG4gICAgbGV0IHtwcmV0dGlmeUZpbGV9ID0gcmVxdWlyZSgnLi9wcmV0dGlmeScpXG5cbiAgICB0aGlzLmRpc3Bvc2FibGVzLmFkZChcbiAgICAgIGF0b20uY29tbWFuZHMuYWRkKCdhdG9tLXRleHQtZWRpdG9yW2RhdGEtZ3JhbW1hcn49XCJoYXNrZWxsXCJdJywge1xuICAgICAgICAnaWRlLWhhc2tlbGw6cHJldHRpZnktZmlsZSc6ICh7Y3VycmVudFRhcmdldH0pID0+XG4gICAgICAgICAgcHJldHRpZnlGaWxlKGN1cnJlbnRUYXJnZXQuZ2V0TW9kZWwoKSksXG4gICAgICAgICdpZGUtaGFza2VsbDpjbG9zZS10b29sdGlwJzogKHtjdXJyZW50VGFyZ2V0LCBhYm9ydEtleUJpbmRpbmd9KSA9PiB7XG4gICAgICAgICAgbGV0IGNvbnRyb2xsZXIgPSB0aGlzLnBsdWdpbk1hbmFnZXIuY29udHJvbGxlcihjdXJyZW50VGFyZ2V0LmdldE1vZGVsKCkpXG4gICAgICAgICAgaWYgKCFjb250cm9sbGVyKSByZXR1cm5cbiAgICAgICAgICBpZiAoY29udHJvbGxlci5oYXNUb29sdGlwcyAmJiBjb250cm9sbGVyLmhhc1Rvb2x0aXBzKCkpIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuaGlkZVRvb2x0aXAoKVxuICAgICAgICAgIH0gZWxzZSBpZiAoYWJvcnRLZXlCaW5kaW5nKSB7XG4gICAgICAgICAgICBhYm9ydEtleUJpbmRpbmcoKVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgJ2lkZS1oYXNrZWxsOm5leHQtZXJyb3InOiAoKSA9PiB0aGlzLnBsdWdpbk1hbmFnZXIubmV4dEVycm9yKCksXG4gICAgICAgICdpZGUtaGFza2VsbDpwcmV2LWVycm9yJzogKCkgPT4gdGhpcy5wbHVnaW5NYW5hZ2VyLnByZXZFcnJvcigpXG4gICAgICB9KSlcblxuICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKFxuICAgICAgYXRvbS5jb21tYW5kcy5hZGQoJ2F0b20tdGV4dC1lZGl0b3JbZGF0YS1ncmFtbWFyfj1cImNhYmFsXCJdJywge1xuICAgICAgICAnaWRlLWhhc2tlbGw6cHJldHRpZnktZmlsZSc6ICh7Y3VycmVudFRhcmdldH0pID0+XG4gICAgICAgICAgcHJldHRpZnlGaWxlKGN1cnJlbnRUYXJnZXQuZ2V0TW9kZWwoKSwgJ2NhYmFsJylcbiAgICAgIH0pKVxuXG4gICAgYXRvbS5rZXltYXBzLmFkZCgnaWRlLWhhc2tlbGwnLCB7XG4gICAgICAnYXRvbS10ZXh0LWVkaXRvcltkYXRhLWdyYW1tYXJ+PVwiaGFza2VsbFwiXSc6XG4gICAgICAgIHsnZXNjYXBlJzogJ2lkZS1oYXNrZWxsOmNsb3NlLXRvb2x0aXAnfVxuICAgIH0pXG5cbiAgICBsZXQge01haW5NZW51TGFiZWx9ID0gcmVxdWlyZSgnLi91dGlscycpXG4gICAgdGhpcy5tZW51ID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKVxuICAgIHRoaXMubWVudS5hZGQoYXRvbS5tZW51LmFkZChbe1xuICAgICAgbGFiZWw6IE1haW5NZW51TGFiZWwsXG4gICAgICBzdWJtZW51OiBbXG4gICAgICAgIHtsYWJlbDogJ1ByZXR0aWZ5JywgY29tbWFuZDogJ2lkZS1oYXNrZWxsOnByZXR0aWZ5LWZpbGUnfSxcbiAgICAgICAge2xhYmVsOiAnVG9nZ2xlIFBhbmVsJywgY29tbWFuZDogJ2lkZS1oYXNrZWxsOnRvZ2dsZS1vdXRwdXQnfVxuICAgICAgXX1dKSlcblxuICAgIGxldCBVUEkgPSByZXF1aXJlKCcuL3VwaS0wLjMnKVxuICAgIHRoaXMudXBpMyA9IG5ldyBVUEkodGhpcy5wbHVnaW5NYW5hZ2VyKVxuICB9LFxuXG4gIGRlYWN0aXZhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnBsdWdpbk1hbmFnZXIuZGVhY3RpdmF0ZSgpXG4gICAgdGhpcy5wbHVnaW5NYW5hZ2VyID0gbnVsbFxuICAgIHRoaXMudXBpMy5kaXNwb3NlKClcbiAgICB0aGlzLnVwaTMgPSBudWxsXG5cbiAgICBhdG9tLmtleW1hcHMucmVtb3ZlQmluZGluZ3NGcm9tU291cmNlKCdpZGUtaGFza2VsbCcpXG5cbiAgICAvLyBjbGVhciBjb21tYW5kc1xuICAgIHRoaXMuZGlzcG9zYWJsZXMuZGlzcG9zZSgpXG4gICAgdGhpcy5kaXNwb3NhYmxlcyA9IG51bGxcblxuICAgIHRoaXMubWVudS5kaXNwb3NlKClcbiAgICB0aGlzLm1lbnUgPSBudWxsXG4gICAgYXRvbS5tZW51LnVwZGF0ZSgpXG4gIH0sXG5cbiAgc2VyaWFsaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMucGx1Z2luTWFuYWdlcikgcmV0dXJuIHRoaXMucGx1Z2luTWFuYWdlci5zZXJpYWxpemUoKVxuICB9LFxuXG4gIHByb3ZpZGVVcGk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnVwaVByb3ZpZGVkID0gdHJ1ZVxuICAgIGNvbnN0IFVQSSA9IHJlcXVpcmUoJy4vdXBpJylcbiAgICByZXR1cm4gbmV3IFVQSSh0aGlzLnBsdWdpbk1hbmFnZXIpXG4gIH0sXG5cbiAgcHJvdmlkZVVwaTM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnVwaVByb3ZpZGVkID0gdHJ1ZVxuICAgIHJldHVybiB0aGlzLnVwaTNcbiAgfSxcblxuICBjb25zdW1lTGludGVyOiBmdW5jdGlvbiAoaW5kaWVSZWdpc3RyeSkge1xuICAgIGxldCBsaW50ZXIgPSBpbmRpZVJlZ2lzdHJ5LnJlZ2lzdGVyKHtuYW1lOiAnSURFLUhhc2tlbGwnfSlcbiAgICB0aGlzLmRpc3Bvc2FibGVzLmFkZChsaW50ZXIpXG4gICAgdGhpcy5wbHVnaW5NYW5hZ2VyLnNldExpbnRlcihsaW50ZXIpXG4gICAgcmV0dXJuIGxpbnRlclxuICB9XG59XG4iXX0=